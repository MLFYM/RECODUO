# Recommender System For Music

> 추천시스템을 서비스에 적용하는 과정을 간략하게 기록했습니다. 



## Two Matrices for Recommend



### Matrix 1. 태그 유사도 

플레이리스트 데이터에서 태그간에 상관관계를 Word2Vec 을 통해서 유사도를 추출했다.

| 태그\태그 | 여름 |  락  | 회상 | ...  |
| :-------: | :--: | :--: | :--: | :--: |
|   여름    |  1   | 0.92 | 0.49 | ...  |
|    락     | 0.92 |  1   | 0.14 | ...  |
|   회상    | 0.49 | 0.14 |  1   | ...  |
|    ...    | ...  | ...  | ...  |  1   |

> Figure 4 : 태그-태그 유사도 행렬에 대한 예시 도표



### Matrix 2. 유저-아이템 선호도 관계

플레이리스트 데이터에서 각 플레이리스트에 포함된 곡들의 좋아요 개수를 선호도로 가정하고 이를 행렬분해의 잠재요인 분석 방식 및 ALS 최적화를 통해 유저-아이템 간의 선호도 매트릭스를 생성했다. 

| 플레이리스트(id)\노래(id) | LA SONG |  깡  | 차에 타봐 | ...  |
| :-----------------------: | :-----: | :--: | :-------: | :--: |
|             1             |  0.24   | 0.92 |   0.74    | ...  |
|             2             |  0.18   | 0.99 |   0.38    | ...  |
|             3             |  0.24   | 0.14 |   0.11    | ...  |
|            ...            |   ...   | ...  |    ...    | ...  |

> Figure 5 : 유저-아이템 선호도 행렬에 대한 예시 도표



### 3. The Flow for Recommend

아래 순서는 두개의 행렬을 사용하여 음악 추천을 하는 방식을 간단하게 정리한 것이다.

1. Input 데이터(태그정보 및 곡 id 정보) 예측

2. Input 데이터의 태그정보와 가장 유사한 TOP N개의 태그를 Matrix-1(태그 유사도)에서 찾는다.

   <img src="C:\Users\bruce0809\AppData\Roaming\Typora\typora-user-images\image-20200516100051306.png" alt="image-20200516100051306" style="zoom:67%;" />

3. 태그를 가진 플레이리스트를 기존에 가지고 있는 곡 메타데이터에서 추출한다.

4. Matrix-2에서 추출된 플레이리스트 정보 마다의 TOP 5 추천곡을 생성한다.

5. 이렇게 후보군 리스트를 만들고 랜덤으로 추천한다

   - 우선순위 1 : ALS를 통해Input 데이터의 노래와 가장 유사한 음악 후보군을 선정하고, 기존에 만든 후보군 리스트가 있으면 그 곡을 추천
   - 우선순위 2 : 후보군 리스트 중 가장 반복 언급 많이 된 상위 노래를 추천

